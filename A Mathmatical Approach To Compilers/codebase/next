follow the pipeline diagram in appendix 2
