i ave tried to avoid copying arrays and recursive calls for subarrays
